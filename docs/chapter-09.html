<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insight App - Chapter 9</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Tinos:wght@700&display=swap');
        
        body {
            background-color: #007BFF; /* ビビットなブルー */
            font-family: 'Noto Sans JP', sans-serif;
        }

        /* 英語フォントをTimes New Romanに設定 */
        .font-english {
            font-family: 'Tinos', 'Times New Roman', serif;
            font-weight: 700;
            font-size: 1.25rem; /* 20px */
            line-height: 1.75rem; /* 28px */
        }

        .answer-span {
            color: #DC2626; /* 赤色 */
            font-weight: 700;
            display: none;
        }

        .underline-span {
            text-decoration: underline;
            text-underline-offset: 4px;
            display: inline;
        }

        .show-answer .answer-span {
            display: inline;
        }

        .show-answer .underline-span {
            display: none;
        }
        
        .explanation {
            display: none;
            white-space: pre-wrap;
        }

        /* Button Styles for Modal */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .btn-primary {
            background-color: #3b82f6;
            color: white;
        }
        .btn-primary:hover {
            background-color: #2563eb;
        }
        .btn-secondary {
            background-color: #6b7280;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #4b5563;
        }
    </style>
</head>
<body class="text-gray-800">

    <div id="app-container" class="container mx-auto p-4 md:p-8 max-w-4xl">
        <header class="text-center mb-8 bg-blue-500 p-4 rounded-xl shadow-lg">
            <h1 class="text-2xl md:text-3xl font-bold text-white">Insight 英文法・語法・熟語</h1>
            <h2 id="app-subtitle" class="text-xl md:text-2xl font-bold text-white">学習用サイト（Chapter 9）</h2>
        </header>

        <main class="bg-white/90 backdrop-blur-sm p-6 rounded-xl shadow-lg mb-28">
            <div class="flex justify-between items-center mb-6">
                 <!-- PDF Control Section -->
                 <div class="flex-1 mr-4">
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                        <h3 class="font-bold text-sm md:text-base mb-2">選択した問題でPDFを作成</h3>
                        <div class="flex flex-col md:flex-row md:items-center justify-between gap-3">
                            <div class="flex items-center">
                                <input type="checkbox" id="select-all-checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <label for="select-all-checkbox" class="ml-2 text-sm font-medium text-gray-700 cursor-pointer">すべて選択 / 解除</label>
                            </div>
                            <button id="open-pdf-modal-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow text-sm transition-transform transform hover:scale-105">
                                PDF作成メニュー
                            </button>
                        </div>
                    </div>
                </div>

                <button id="start-quiz-btn" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg shadow transition-transform transform hover:scale-105 whitespace-nowrap">
                    ランダムテスト
                </button>
            </div>

            <div id="sentence-list" class="space-y-6">
                <!-- Sentences will be populated by JS -->
            </div>
        </main>
    </div>

    <!-- Control Panel -->
    <div id="control-panel" class="fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-md p-4 border-t-2 border-gray-200 shadow-2xl flex justify-center items-center space-x-2 md:space-x-4">
        <button id="toggle-answer-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105">表示/非表示</button>
        <button id="play-sound-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105">音声再生</button>
        <button id="record-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105">録音評価</button>
        <button id="toggle-explanation-btn" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105">解説</button>
    </div>

    <!-- Message/Score Modal -->
    <div id="message-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
        <div id="message-content" class="bg-white p-8 rounded-lg shadow-xl text-center">
            <!-- Message content will be populated by JS -->
        </div>
    </div>
    
    <!-- Quiz Modal -->
    <div id="quiz-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-40 p-4">
        <div class="bg-white w-full max-w-2xl p-8 rounded-2xl shadow-2xl relative">
            <button id="close-quiz-btn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-3xl font-bold">&times;</button>
            <div id="quiz-content">
                <!-- Quiz content will be populated by JS -->
            </div>
        </div>
    </div>

    <!-- PDF Download Modal -->
    <div id="pdf-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50">
        <div class="relative mx-auto p-5 border w-11/12 md:w-1/2 lg:w-1/3 shadow-lg rounded-md bg-white">
            <div class="mt-3 text-center">
                <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">ダウンロードするPDFの種類を選択</h3>
                <div class="mt-2 space-y-3">
                    <button id="download-list-btn" class="btn btn-primary w-full justify-start text-left">1. 完全なリスト (熟語・意味・例文)</button>
                    <button id="download-en-quiz-btn" class="btn btn-primary w-full justify-start text-left">2. 熟語テスト (英語を解答)</button>
                    <button id="download-ja-quiz-btn" class="btn btn-primary w-full justify-start text-left">3. 熟語テスト (意味を解答)</button>
                    <button id="download-mixed-quiz-btn" class="btn btn-primary w-full justify-start text-left">4. 熟語テスト (混合)</button>
                    <button id="download-sentence-quiz-btn" class="btn btn-primary w-full justify-start text-left">5. 例文の穴埋め問題</button>
                    <button id="download-sentence-mixed-quiz-btn" class="btn btn-primary w-full justify-start text-left">6. 例文の混合問題 (穴埋め/和訳)</button>
                </div>
                <div class="mt-6">
                    <button id="close-modal-btn" class="btn btn-secondary w-full">キャンセル</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const chapterData = [
    {
        "id": "1",
        "ja": "2 3 4 5 6 7 8 9 10音読 接続詞 2 3 4 5 6 7 8 9 10音読 接続詞 2 3 4 5 6 7 8 9 10音読 接続詞 2 3 4 5 6 7 8 9 10音読 接続詞 2 3 4 5 6 7 8 9 10音読 接続詞 2 3 4 5 6 7 8 9 10音読 接続詞 2 3 4 5 6 7 8 9 10音読 接続詞 2 3 4 5 6 7 8 9 10音読 接続詞 2 3 4 5 6 7 8 9 10音読 接続詞",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "ͷѻ͍File32 ͷthatࢺ：  that …ʮ…ͱ͍͏ ʯFile33 અΛಋ͘if ͱwhetherFile34"
    },
    {
        "id": "9",
        "ja": "接続詞 ◀\t音読用動画 別解など 接続詞 文法編 ｜  9章 接続詞 文法編 ｜  9章 接続詞 文法編 ｜  9章 接続詞 文法編 ｜  9章 接続詞 文法編 ｜  9章 接続詞 文法編 ｜  9章 接続詞 文法編 ｜  9章 接続詞",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": ""
    },
    {
        "id": "223",
        "ja": "9章 接続詞",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "①"
    },
    {
        "id": "223-1",
        "ja": "私たちはそのカフェで食事をしたかったが， 混んでいたので，あきらめた。",
        "en": "We wanted to eat at the café, {but it was crowded, so we gave up.}",
        "answer": "but it was crowded, so we gave up.",
        "explanation": "▶ ࢺは語と語，句と句，節と節を対等な関係で結ぶ働きがあり，and「そ\nし て 」，or「 ま た は 」，but「 し か し 」，so「 そ れ で ， だ か ら 」，for「というのは…だ\nから」などがある。➡Grasp16   ただし，so と for は節と節を結ぶ用法しかない。\nA …, but B …ʮAʜɼ͔͠͠Bʜʯ―逆接を表す。",
        "question": "We wanted to eat at the café, (      ) it was crowded, (      ) we gave up."
    },
    {
        "id": "223-2",
        "ja": "テ クノロ ジ ー が 雇 用 を 生 み 出 すのは事実だが，そのために職を失う人もいる。",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "It  technology creates jobs,  some people lose their jobs because of it. It is true (that) technology creates jobs, but some people lose their jobs because of it. It is true (that) ʙ, but …ʮʙͱ͍͏ͷ͸ຊ౰͕ͩɼʜʯ lose one’s job͢Δʯ⇔⇔ get a jobʮब৬͢Δʯ"
    },
    {
        "id": "224",
        "ja": "発展 彼は幸せを感じているが，それでも時に寂しさも感じる。",
        "en": "He feels happy, {yet} sometimes he feels lonely too.",
        "answer": "yet",
        "explanation": "▶ このyet は接続詞。副詞で使う場合は「まだ （…ない） 」などの意味。➡846",
        "question": "He feels happy, (        ) sometimes he feels lonely too."
    },
    {
        "id": "225",
        "ja": "次の角を右に曲がると，博物館が見える でしょう。",
        "en": "{Turn right at the next corner, and you’ll see the museum. ໋ྩจ, and …ʮʙ͠ͳ͍͞ɼͦ͏͢Ε͹ʜʯ ＝If you turn right at the next corner, youʼll see the museum.}",
        "answer": "Turn right at the next corner, and you’ll see the museum. ໋ྩจ, and …ʮʙ͠ͳ͍͞ɼͦ͏͢Ε͹ʜʯ ＝If you turn right at the next corner, youʼll see the museum.",
        "explanation": "",
        "question": "(T      ) (        ) at the next corner, (        ) you’ll see the museum."
    },
    {
        "id": "226",
        "ja": "急がないと電車に乗り遅れるよ。",
        "en": "{Hurry up, or you’ll be late for your train. ໋ྩจ, or … / ໋ྩจ, otherwise …ʮʙ͠ͳ͍͞ɼ͞΋ͳ͍ͱʜʯ ＝If you don’t hurry up, youʼll be late for your train.}",
        "answer": "Hurry up, or you’ll be late for your train. ໋ྩจ, or … / ໋ྩจ, otherwise …ʮʙ͠ͳ͍͞ɼ͞΋ͳ͍ͱʜʯ ＝If you don’t hurry up, youʼll be late for your train.",
        "explanation": "",
        "question": "(H      ) (        ), (        ) you’ll be late for your train."
    },
    {
        "id": "227",
        "ja": "教育におけるAIの使用には賛否両論がある。 A とB には対等なもの （語・句・節） を置く。主語と して使う場合は複数扱いする。 pros and cons൱྆࿦ʯʕpro は「賛成票」 ，con は「反対票」の意味。",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "There (        ) (        ) (p      ) (        ) (c      ) to using AI in education. There are both pros and cons to using AI in education. both A and BʮA ΋B ΋ɼA ͱB ͷ྆ํʯ"
    },
    {
        "id": "228",
        "ja": "飲酒運転は違法であるだけでなく非常に危険だ。 A とB には対等なもの （語・句・節） を置く。問題文ではillegal とextremely dangerous。",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "Drunk driving is (        ) (o      ) (i      ) (        ) (        ) extremely (d      ). Drunk driving is not only illegal but also extremely dangerous."
    },
    {
        "id": "229",
        "ja": "『羅生門』は小説ではなく，短編小説だ。 語と語を結ぶ 句と句を結ぶ 主語 （主部） 動 詞 A and BʮA ͱBʯɹ  both A and BʮA ΋B ΋ʯ 複数扱い neither A nor BʮA ΋B ΋ʙͳ͍ʯ B（単数）に合わせるか，複数扱い 接続詞ࢺ ࢺ節に節をつなげる 節と節を結ぶ 復習",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "Rashomon is . Rashomon is not a novel(,) but a short story. અΛಋ͘ અΛಋ͘ B as well as AʮA ͱಉ༷B ΋ʯ➡285 either A or BʮA ͔ B ͷͲͪΒ͔ʯ ࢺ16Grasp 118 119 Self Check"
    },
    {
        "id": "230",
        "ja": "君かケンのどちらかが明日の朝食のパンを買って来る必要がある。 ②文法編 ｜  9章文法編 ｜  9章",
        "en": "{Either you or Ken needs to buy bread for tomorrow’s breakfast. either A or BʮA ͔ B ͷͲͪΒ͔ʯ➡File32– p.119}",
        "answer": "Either you or Ken needs to buy bread for tomorrow’s breakfast. either A or BʮA ͔ B ͷͲͪΒ͔ʯ➡File32– p.119",
        "explanation": "▶ 主語と して使う場合，動詞はB（単数） に合わせるか，複数扱いする。\nneither A nor BʮA ΋B ΋ʙͳ͍ʯ―動詞は B（単数） に合わせるか，複数扱い。\nNeither you nor Sara is [are] required to attend the meeting.\n（君もサラもそのミーティ ングに出席する必要はない。）",
        "question": "(        ) you (        ) Ken needs to buy bread for tomorrow’s breakfast. ask / wonder / long"
    },
    {
        "id": "231",
        "ja": "実のところ，人間の行動は複雑だ。",
        "en": "The {fact is (that)} human behavior is complicated.",
        "answer": "fact is (that)",
        "explanation": "▶ ࢺ［ࢺ］はैଐઅを導く。➡ͱઅͷ·ͱΊ4 – p.141   従属節\nには名詞節と副詞節がある。➡Grasp16– p.118   名詞節は文の主語・目的語・\n補語になる。副詞節は時・条件・理由などの意味を表し，主節を修飾する。\n名詞節を導く接続詞thatʮʜͱ͍͏͜ͱʯ― 省 略されることも多い。\n▶ that は名詞節をつく り，文の主語・目的語・補語になる。ただし，前置詞の目\n的語にはならない。この問題文のthat節は文の補語になっている。\nThe fact is (that) …ͷͱ͜Ζʜͩʯ\nThe trouble is (that) …ͬͨ͜ͱʹ…ͩʯ",
        "question": "The  human behavior is complicated."
    },
    {
        "id": "232-1",
        "ja": "そんなに多くの食べ物を廃棄しているという事実は大きな問題だ。",
        "en": "{The fact that we waste so much food is a big problem. A that …ʮʜͱ͍͏Aʯ}",
        "answer": "The fact that we waste so much food is a big problem. A that …ʮʜͱ͍͏Aʯ",
        "explanation": "▶ that は֨の名詞節を導く接続詞。that節が直前の名詞の具体的な内容を\n表す。同格のthat節と結びつく名詞は限られている。➡File33, Grasp17",
        "question": "(        ) (        ) (        ) we waste so much food is a big problem."
    },
    {
        "id": "232-2",
        "ja": "AIは人類にと っ て危険になる可能性がある。",
        "en": "There is a {possibility that} AI can be dangerous to humans.",
        "answer": "possibility that",
        "explanation": "▶ that は同格の名詞節を導く接続詞。➡232-1   同格を導くthat は口語では省略\nされることがあるが，入試の英作文では省略しないほうが無難。\nᶃ 事実・根拠・可能性を表す名詞 ɹ  factʯɹ  truthɼਅཧʯ\ncase৘ʯɹ  evidence / proofʯɹ  groundsɼཧ༝ʯ\ncertaintyΈʯɹ  chance / possibilityʮՄೳੑʯ\nprobabilityΈʯɹ  likelihoodΈɼՄೳੑʯɹ  dangerੑʯ\nᶄ 情報・知識を表す名詞 ɹ  informationʮ৘ใʯɹ  knowledgeʯ\nnews /nJu\\z/ʮ஌Βͤɼχϡʔεʯɹ  rumorʮ͏Θ͞ʯɹ  reportʯ\nrecord࿥ʯ\nᶅ 感情・思考・認識を表す名詞 ɹ  feeling৘ʯɹ  impressionʮҹ৅ʯ\nfearΕʯɹ  idea / thought͑ʯɹ  concept೦ʯ\ntheoryʮཧ࿦ʯɹ  opinion / observationʯ\nclaim / assertionʮओுʯɹ  complaint৘ʯɹ  doubt /daÜt/͍ʯ\nrecognitionʯɹ  beliefʮ৴೦ʯ\nᶆ 提案・決定を表す名詞 ɹ  suggestion / proposalʮఏҊʯɹ  suppositionʮԾఆʯ\nconditionʯ  decisionఆʯɹ  conclusion࿦ʯ\nᶇ 要求・期待・希望を表す名詞 ɹ  demandʯɹ  expectation଴ʯ\nhope๬ʯɹ  desire๬ʯ\n(1) I ʼm aware of the fact that Ken is trying to hide .［関係代名詞のthat］\n（私はケンが隠そう と している事実 ［の内容］ に気づいている。 ）\nthat節の中は不完全な文。hide の目的語が関係代名詞that として前に出ている。\n(2) I ʼm aware of the fact that Ken is trying to hide the evidence.［同格のthat］\n（私はケンが証拠を隠そう と しているという事実に気づいている。 ）\nthat節の中は完全な文。that節の内容＝the fact という関係。\n(3) It is clear that Ken is trying to hide the evidence.［形式主語で使われるthat］\n（ ケ ン が 証 拠 を 隠 そ う と し て い る こ と は 明 ら か だ 。）\nthat節をそのままit の代わりに置いても意味が通じる。It ＝that 節。\nThat Ken is trying to hide the evidence is clear.\n⭢ 主語が長くなり，ややぎこちない文にはなるが文意は通じる。\n(4) It is this evidence that Ken is trying to hide.［強調構文で使われるthat］\n（ ケ ン が 隠 そ う と し て い る の は こ の 証 拠 だ 。）\n強調構文はIt, is, that を削除して語句を並べかえると完全な文になる。\nKen is trying to hide this evidence.  ⭢ this evidence はhide の目的語。\nthatͷ͞·͟·ͳ༻๏17Grasp\n120 121\n復習\nSelf\nCheck",
        "question": "There is a  AI can be dangerous to humans."
    },
    {
        "id": "233",
        "ja": "サラに一緒に美術館に行きたいかどうか聞いてみるよ。",
        "en": "I’ll {ask Sara if [whether] she wants to go to the museum with us.}",
        "answer": "ask Sara if [whether] she wants to go to the museum with us.",
        "explanation": "▶ 目的語になるif અʮʜ͔Ͳ͏͔ʯ―名詞節  ➡副詞節のif は25 を参照。\nif は名詞節をつく り，文の目的語になる。➡File34\nask A if [whether] …ʮʜ͔Ͳ͏͔A ʹਘͶΔʯ",
        "question": "I’ll (        ) (        ) (        ) she wants to go to the museum with us."
    },
    {
        "id": "234",
        "ja": "科学技術が良いものか悪いものかは，それがどのように使われるかによる。",
        "en": "{Whether technology is good or bad depends on how it is used.}",
        "answer": "Whether technology is good or bad depends on how it is used.",
        "explanation": "▶ 文の主語・目的語・補語・前置詞の目的語になるwhether અʮʜ͔Ͳ͏͔ʯ\nwhether A or BʮA ͔ͦΕͱ΋B ͔ʯ―名詞節\nwhether 節は主語になるが，if節は主語・補語・前置詞の目的語にはならない。\nIf technology is good or bad depends on how it is used.\nただし，形式主語it の真の主語にはなる。➡File34\nIt is doubtful if Ken will accept the offer.\n（ケンがその申し出を受けるかどうかは疑 わ し い 。）\nwhether は副詞節を導いて譲歩の意味を表すこと もある。➡256\ndepend on A   ᶃʮA ʹཔΔɼA ʹґଘ͢Δʯ ᶄʮA·Δʯ",
        "question": "(        ) (t      ) (        ) (g      ) (        ) (b      ) depends on how it is used."
    },
    {
        "id": "235",
        "ja": "明日は晴れるだろうか。",
        "en": "I {wonder if [whether] it will be sunny tomorrow. wonder if [whether] …͏ʯ}",
        "answer": "wonder if [whether] it will be sunny tomorrow. wonder if [whether] …͏ʯ",
        "explanation": "▶ if 節，whether 節は名詞節。➡File34, 名詞節のif は28 を参照。",
        "question": "I  it will be sunny tomorrow."
    },
    {
        "id": "236",
        "ja": "駅に着いたら君 にメッセ ー ジを 送 るよ 。",
        "en": "I’ll text you when I get to the station. when …ʹʯ―副詞節を導く接続詞    when I will get to …",
        "answer": "when I get to the station. when …ʹʯ―副詞節を導く接続詞 when I will get to …",
        "explanation": "▶ when は時を表す副詞節を導く接続詞。時や条件を表す副詞節の中では，\n未来のことでもwill は使わず，現在形や現在完了形を使う。➡22",
        "question": "I’ll text you (w     ) (        ) (        ) (        ) the station."
    },
    {
        "id": "237-1",
        "ja": "手遅れになる前に気候変動に対処しなければならない。",
        "en": "We must address climate change {before it is too late. before …ʮʜ͢Δલʹʯ⇔ after …ʹʯ it is [it’s] too lateʮख஗Εͩʯ address [tackle] climate changeมಈʹରॲ͢Δʯ}",
        "answer": "before it is too late. before …ʮʜ͢Δલʹʯ⇔ after …ʹʯ it is [it’s] too lateʮख஗Εͩʯ address [tackle] climate changeมಈʹରॲ͢Δʯ",
        "explanation": "",
        "question": "We must address climate change (        ) it (        ) (t      ) (l      )."
    },
    {
        "id": "237-2",
        "ja": "服を着替えたら合流するよ。",
        "en": "I’ll join you {after I change my clothes. after …ʹʯ⇔ before …ʮʜ͢Δલʹʯ change one’s clothesʮ෰Λணସ͑Δʯ}",
        "answer": "after I change my clothes. after …ʹʯ⇔ before …ʮʜ͢Δલʹʯ change one’s clothesʮ෰Λணସ͑Δʯ",
        "explanation": "",
        "question": "I’ll join you (        ) (        ) (        ) my clothes."
    },
    {
        "id": "238",
        "ja": "その 新しいレストランはまもなく開店するだろう。 ⇧「…する前に長くはかからないだろう」 before 節は時を表す副詞節では，未来のことでも現在形を使う。 主語 形式主語 it の 真の主語 目的語 前置詞の 目的語 補語 if節 whether節 復習",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "It  the new restaurant . It will not be long before the new restaurant opens. It will not [won’t] be long before …ʮ·΋ͳ͘ʜ͢ΔͩΖ͏ʯ 122 123 Self Check"
    },
    {
        "id": "239",
        "ja": "私は８歳の頃から英語を習っている。",
        "en": "I {have been learning English since I was eight. since …ʮʜ͠ ͯҎདྷʯ}",
        "answer": "have been learning English since I was eight. since …ʮʜ͠ ͯҎདྷʯ",
        "explanation": "▶ since は主節の動作や出来事が始まった過去の起点を表す。現在完了形と共に使\nうことが多い。since はbecause や as と同じように理 由を表 すこともある。➡259",
        "question": "I (        ) (        ) (        ) English (        ) (        ) (        ) eight."
    },
    {
        "id": "240",
        "ja": "日本の多くの親は就職するまで子どもの面倒を見る。",
        "en": "Many parents in Japan take care of their children {until they get a job.}",
        "answer": "until they get a job.",
        "explanation": "▶ 〈S＋V until S′＋V′〉 の 形 。〈until S′＋V′〉 は終了時点を表す。 「その終了時点\nまで」主節 （S＋V） の動作や行為が続く ことを表す。\nget a job ʮब৬͢Δʯ⇔⇔ lose one’s job͢Δʯ",
        "question": "Many parents in Japan take care of their children (        ) (        ) (g      ) a ( j      )."
    },
    {
        "id": "241",
        "ja": "健康を損 なって初 めて，その価値に気づく。",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "-1 -2＝ You (       ) (       ) (r      ) the value of your health (       ) (       ) (l      ) it. ( you / is / until / it / lose / not ) your health ( realize / that / you ) its value."
    },
    {
        "id": "241-1",
        "ja": "???",
        "en": "-2＝ You do [will] not realize the value of your health until you lose it. It is not until you lose your health that you realize its value. not ʙ until [till] … It is not until … that ʙ    ʮʜͯ͠ॳΊͯʙ͢Δʯ ⇧「 … ま で（until …）～ し な い（not ～ ）⭢ …して初めて～する」",
        "answer": "???",
        "explanation": "▶ It is not until … that ～は，not until … の部分を強調した強調構文。\nlose one’s healthΛଛͳ͏ʯ⇔⇔ improve one’s healthΛ૿ਐ͢Δʯ",
        "question": "???"
    },
    {
        "id": "242",
        "ja": "私たちが到着する頃には，コンサートはもう始まっているだろう。",
        "en": "By {the time we arrive}, the concert will have already started.",
        "answer": "the time we arrive",
        "explanation": "▶ 〈By the time S′＋V′, S＋V〉の 形 。〈by the time S′＋V′〉 は期限を 表 す 。「 そ の 期\n限まで」のどこかの時点で主節 （S＋V） の動作や出来事が完了していることを表す。\nuntil, till は接続詞と前置詞の両方の働きをするが，by the time は接続詞，by は前\n置詞の働きのみ。",
        "question": "By , the concert will have already started."
    },
    {
        "id": "243",
        "ja": "子どもたちを巻き込んだ事故について聞くたび胸が痛む。",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "My heart breaks (        ) (        ) (        ) (h      ) about accidents involving children. My heart breaks every time I hear about accidents involving children. every time … each time …    ʮʜ͢Δͨͼʹʯ (the) next time …ʹ…ʯ／the first time …ʮॳΊͯ…ʯ the last time …ʹ…ɼ͜ͷલ…ʯ"
    },
    {
        "id": "244",
        "ja": "家に帰ったらすぐに宿題を始めます。",
        "en": "As soon as I get home, I’ll start my homework. as soon as … ʮʜ͢Δͱ͙͢ʹʯ  as soon as I will get home ＝the moment … ＝the instant … ＝on doing",
        "answer": "As soon as I get home, I’ll start my homework. as soon as … ʮʜ͢Δͱ͙͢ʹʯ as soon as I will get home ＝the moment … ＝the instant … ＝on doing",
        "explanation": "▶ 時を表す副詞節では，未来のことでも現在形を使う。",
        "question": "(        ) (s      ) (        ) I (g      ) (        ), I’ll start my homework."
    },
    {
        "id": "245",
        "ja": "彼らはビーチに 着くとすぐに，海へ飛び込んだ。 復習",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "The  the beach, they jumped into the water. The moment they got to the beach, they jumped into the water. the moment … the instant …       ʯ ＝as soon as … ＝on doing jump [dive] into the waterΉʯ learn / get / realize / lose / hear / get home / get to 124 125 Self Check"
    },
    {
        "id": "246",
        "ja": "大雨 が 降っていなければ，私は毎日，自転車で駅に行く。",
        "en": "{⑤}",
        "answer": "⑤",
        "explanation": "",
        "question": "-1 -2＝ I ride my bike to the station every day (u      ) (        ) (        ) heavily. I ride my bike to the station every day, (e      ) (w     ) (        ) (        ) heavily. ͸ʮʜ͢Δͱ͖Λআ͍ͯ ˠ ɻ͸ʮʜ͢Δͱ͖Λআ͍ͯ ˠ ɻ"
    },
    {
        "id": "246-1",
        "ja": "???",
        "en": "-2＝ I ride my bike to the station every day unless it’s raining heavily. I ride my bike to the station every day, except when it’s raining heavily. unless … except when …    Γʯ",
        "answer": "???",
        "explanation": "▶ 条件を表す副詞節では，未来のことでも現在形を使う。\n〈unless＋肯定文〉 〈except when＋肯定文〉 で「…でなければ，…しない限り」とい\nう否定の意味になる。not などの否定語は不要。",
        "question": "???"
    },
    {
        "id": "247",
        "ja": "発展 天気が良ければ，私たちは外で何かするつもりだ。 providing (that) …    ʮʜͳΒ͹ʯ⇦「 …ということが 与えられると」 直説法 （実際に起こり得ること。そのままの時制） で使う。＝if … go (and) do͘ʯ―and が省略されて動詞が２つ続く ことがある。",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "We’ll go do something outside, (p      ) the (        ) (        ) good. We’ll go do something outside, provided the weather is good. provided (that) …"
    },
    {
        "id": "248-1",
        "ja": "発展 明日，雨が降ったら， 君はどうしますか。",
        "en": "Suppose it rains tomorrow, what will you do? suppose (that) … supposing (that) …    ʮʜͳΒ͹ʯ⇦ 「…ということを想定して」 直説法でも仮定法 （事実に反すること。時制をずらす） でも使う。＝if …",
        "answer": "Suppose it rains tomorrow, what will you do? suppose that … supposing that … ʮʜͳΒ͹ʯ⇦ 「…ということを想定して」 直説法でも仮定法 （事実に反すること。時制をずらす） でも使う。＝if …",
        "explanation": "▶ この問題文は直説法で使われている。",
        "question": "(S      ) (        ) (        ) tomorrow, what (        ) you do?"
    },
    {
        "id": "248-2",
        "ja": "発展 宝くじ が当たったら，君はそのお金で何をしますか。",
        "en": "{Suppose you won the lottery, what would you do with the money?}",
        "answer": "Suppose you won the lottery, what would you do with the money?",
        "explanation": "▶ suppose [supposing] (that) …「…ならば」は仮定法でも使われる。\nwin a lottery ʮๅ͕͘͡ ౰ͨΔʯ",
        "question": "(S      ) (        ) (w     ) the lottery, what (        ) you do with the money?"
    },
    {
        "id": "249",
        "ja": "あなたが世話をするのを約束するという条件で，子犬を買っ てあげます。",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "We’ll buy you a puppy ( to / promise / the condition / on / you / that ) take care of it. We’ll buy you a puppy on the condition that you promise to take care of it. on (the) condition (that) …ͷΈʯ＝only if … puppyʯ⇔⇔ kittenೣʯ promise to do ʮʙ͢Δͱ໿ଋ͢Δʯ"
    },
    {
        "id": "250-1",
        "ja": "安ければどんなホテルでも構わない。 will do ʮ༻ ͕ ଍ Γ Δʢ ͩ Ζ ͏ ʣʯ―このdo については ➡609",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "Any hotel will do as . Any hotel will do as long as it’s cheap. as long as …       ͱ͠ ͯʣʜ͑͢͠͞Ε͹ʢʹon condition that …ʣʯ so long as …    Γʯ➡250-2"
    },
    {
        "id": "250-2",
        "ja": "太陽が輝く限り，太陽エネルギーは利用できる。",
        "en": "As {long as the Sun shines}, solar energy will be available.",
        "answer": "long as the Sun shines",
        "explanation": "▶ 「…する限り」 ，つま り「…する間は」の意味でas long as が使われている。",
        "question": "As  the Sun , solar energy will be available."
    },
    {
        "id": "251",
        "ja": "私の知る限り，自然食品を食べるこ とは健康に良い。 復習",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "(        ) (        ) (        ) (        ) (        ), eating organic food is good for our health. As far as I know, eating organic food is good for our health. ＝to the best of my knowledge as far as the eye can seeΓʯ be good for one ’s healthʹྑ͍ʯ except / provide / weather / suppose / shine 126 127 Self Check"
    },
    {
        "id": "252",
        "ja": "一度自転車の乗り方を覚えると， ずっと忘 れ な い 。 このonce は副詞節を導く接続詞。副詞で使う と「一度，１回，かつて」の意味。",
        "en": "{⑥}",
        "answer": "⑥",
        "explanation": "",
        "question": "(O      ) (        ) (        ) how to ride a bike, you never forget it. Once you learn how to ride a bike, you never forget it. once …ʮ͍ͬͨΜʜ͢Δͱʯ"
    },
    {
        "id": "253",
        "ja": "私たちは平和を望んでいるが，世界中で戦争が起きている。",
        "en": "Although we want peace, there are wars all over the world. though … although …    ʮʜ͚ͩΕͲ΋ʯ",
        "answer": "Although we want peace, there are wars all over the world. though … although … ʮʜ͚ͩΕͲ΋ʯ",
        "explanation": "▶ though / although は譲歩を表す副詞節を導く接続詞。though とalthough は\n同じ意味を表すが，although はやや硬い表現。文頭で使う場合はalthough が\n好まれる。\nwant peace ʮฏ࿨Λ๬Ήʯ",
        "question": "(A      ) (        ) (w     ) peace, there are wars all over the world."
    },
    {
        "id": "254",
        "ja": "テ クノロ ジ ー は私たちをオンラインでつなぐけれど，私たちに寂しさや孤独を感じさ せるものでもある。",
        "en": "{Even though technology connects us online, it can also make us feel lonely and isolated. even though … ʮʜ͚ͩΕͲ΋ʯ}",
        "answer": "Even though technology connects us online, it can also make us feel lonely and isolated. even though … ʮʜ͚ͩΕͲ΋ʯ",
        "explanation": "▶ though の強調表現。  even although という形はない。\n実際に起こったことや事実について述べる。even if ➡255 との違いに注意。\nfeel lonely and isolated͡Δʯ",
        "question": "(        ) (t      ) (        ) (c      ) us online, it can also make us feel lonely and isolated. ɻɻ"
    },
    {
        "id": "255",
        "ja": "たとえもっとリサイクルしたとしても，それでもプラスチックは最後に海に流れ着く。 実際には起こっていない仮の条件を表す。even though ➡254 との違いに注意。",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "(        ) (i      ) (        ) (        ) more, plastic still ends up in the ocean. Even if we recycle more, plastic still ends up in the ocean. even if … ʮ ͨͱ͑ʜ ͩͱͯ͠΋ʯ end up in Aʹ͸A͖ண͘ʯ"
    },
    {
        "id": "256",
        "ja": "貧富を問わず，誰もが必要な医療を受けるべきだ。",
        "en": "{Whether (they are) rich or poor}, everyone should have the health care they need.",
        "answer": "Whether (they are) rich or poor",
        "explanation": "▶ 副詞節のwhether 節 内 の〈S′＋be動詞〉 は，文意が通じる場合は省略する。\nwhether は名詞節を導く と「…かどうか」の意味を表す。➡234",
        "question": ", everyone should have the health care they need."
    },
    {
        "id": "257-1",
        "ja": "天然資源には限りがあるので，省エネルギーは重要だ。",
        "en": "Energy conservation is important {because our natural resources are limited. energy conservation ʮলΤωϧΪʔʯ⇔⇔ energy wasteʮΤωϧΪʔͷ࿘අʯ natural resourcesʯ}",
        "answer": "because our natural resources are limited. energy conservation ʮলΤωϧΪʔʯ⇔⇔ energy wasteʮΤωϧΪʔͷ࿘අʯ natural resourcesʯ",
        "explanation": "",
        "question": "Energy conservation is important (b      ) our natural resources (a      ) (        )."
    },
    {
        "id": "257-2",
        "ja": "私がボランティアをするのは，1つには新しい人たちと出会うのが楽しいからだ。",
        "en": "I volunteer {partly because I enjoy meeting new people.}",
        "answer": "partly because I enjoy meeting new people.",
        "explanation": "",
        "question": "I volunteer (p      ) (        ) (        ) (e      ) (        ) new people."
    },
    {
        "id": "258",
        "ja": "彼女は，彼 が 金 持ちだからといって結婚したわけではない。 復習",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "She  marry him . She did not marry him just because he was rich. marry AʮA͢Δʯ learn / want / connect / limited / meet 128 129 Self Check"
    },
    {
        "id": "259",
        "ja": "疲れているのだから，しばらく休んだほうがいい。 since は「…して以来」という意味のほかに， 「…なのだから」という理由も表す。 理由を表すsince は 文 頭 に置くことが 多 い 。",
        "en": "⑦",
        "answer": "???",
        "explanation": "",
        "question": ", you should rest for a while. ΘΕΔ͜ͱ͕ଟ͍ɻΘΕΔ͜ͱ͕ଟ͍ɻ Since [As, Because] you are tired, you should rest for a while. rest for a whileΉʯ"
    },
    {
        "id": "260",
        "ja": "テストが 終わったので，リラックスして週末を楽しめる。",
        "en": "{Now that the test is over, I can relax and enjoy my weekend.}",
        "answer": "Now that the test is over, I can relax and enjoy my weekend.",
        "explanation": "▶ このnow は接続詞。is over の用法については ➡840\nbe over ʮऴΘ͍ͬͯΔʯ",
        "question": "(N      ) (        ) the (        ) (        ) (o      ), I can relax and enjoy my weekend."
    },
    {
        "id": "261",
        "ja": "発展 人間が他の動物と違うのは，話したり笑ったりできるという点だ。",
        "en": "Humans differ from other animals {in that we can speak and laugh.}",
        "answer": "in that we can speak and laugh.",
        "explanation": "▶ in that の節は，主節の内容の根拠となる事柄を表す。\nhumansʯ\ndiﬀer from A ʮA ͱ͸ҧ͏ɼA ͱ͸ҟͳΔʯ＝be diﬀerent from A",
        "question": "Humans differ from other animals (        ) (        ) (w     ) (        ) (        ) and laugh."
    },
    {
        "id": "262",
        "ja": "電車がとても混んでいるので， 私は毎朝立たなければならない。 （それはとてもおもしろい本だったので，私は一日で読んだ。 ）",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "The train is ( to / have / crowded / so / that / I ) stand every morning. The train is so crowded that I have to stand every morning. It was so interesting a book that I read it in a day. ＝ The book was so interesting that I read it in a day."
    },
    {
        "id": "263",
        "ja": "とても暑い日だったので，私たちは公営プールに泳ぎに行くことにした。 （それはとてもおもしろい本だったので，私は一日で読んだ。 ）",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "It was ( we / that / a / such / decided / hot day ) to go to the public pool for a swim. It was such a hot day that we decided to go to the public pool for a swim. It was such an interesting book that I read it in a day. ＝ It was so interesting a book that I read it in a day."
    },
    {
        "id": "264",
        "ja": "彼女が音量を上げて くれたので，みんな音声が聞こえた。",
        "en": "She turned up the volume, so that everyone could hear the audio. ʙ, so (that) …Ռʜʯ―結果を表す",
        "answer": "so that everyone could hear the audio. ʙ, so that …Ռʜʯ―結果を表す",
        "explanation": "▶ so (that) の 前 に コン マ（,）を 伴 う 。",
        "question": "She turned up the volume, (        ) (        ) (        ) (        ) (        ) the audio."
    },
    {
        "id": "265",
        "ja": "世の中の仕組みを理解するために，さまざまな経験をするべきだ。",
        "en": "We should have a variety of experiences {so that we can understand how the world works. so that S ˄ can [will, may など] …ʮS˄͕ ʜ ͢ Δ ͨ Ί ʹ ʯ―目的を表す}",
        "answer": "so that we can understand how the world works. so that S ˄ can [will, may など] …ʮS˄͕ ʜ ͢ Δ ͨ Ί ʹ ʯ―目的を表す",
        "explanation": "▶ 「世の中の仕組み」はhow the world works「どのよ うに世界が機能するのか」\nという名詞節で表現されている。\na variety of A ʮ͞·͟·ͳAʯ\nexperience  ࢺ「͢Δʯ\nhow the world works૊Έʯ\nover / in / hear\n130 131\n復習\nSelf\nCheck",
        "question": "We should have a variety of experiences (s      ) (        ) (        ) (        ) understand how the world works."
    },
    {
        "id": "266",
        "ja": "???",
        "en": "⑧",
        "answer": "???",
        "explanation": "",
        "question": "???"
    },
    {
        "id": "266-1",
        "ja": "若いうちにたくさん 本を読 むべきだ 。 「…している間に，…している間じゅう」を意味するwhile節の中の動詞が動作動詞の 場合は，進行形にすることが多い。 （私 が 勉 強している間，私の猫はノートの上にうずくまっていた。 ）",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "We should read a lot of books (        ) (        ) (        ) (y      ). We should read a lot of books while [when] we are young. while …͡Ύ͏ʯ while [when] we are youngʮए͍͏ͪʹʯ While I was studying, my cat sat on my notebook."
    },
    {
        "id": "266-2",
        "ja": "歩きスマホはたいへん危険だ。",
        "en": "＝ Using a smartphone while walking is very dangerous. Walking while using a smartphone is very dangerous. while doingʹʯ―  with doing という表現はない。",
        "answer": "＝ Using a smartphone while walking is very dangerous. Walking while using a smartphone is very dangerous. while doingʹʯ― with doing という表現はない。",
        "explanation": "▶ 分詞構文のdoing「～しながら」の意味を明確にするためにwhile を直前に置\nいた形。while (you are) walking のyou are が 省 略された形とも考えられる。\nwhile walking ʮา͖ͳ͕Βʯ",
        "question": "(U      ) a (        ) (        ) (w     ) is very dangerous."
    },
    {
        "id": "267",
        "ja": "ケンはサッカーが上手だ。一方，私はバスケットボ ール が 得 意 だ 。",
        "en": "Ken plays soccer very well, while [whereas] I am good at basketball. ʙ, while … ʙ, whereas …    ʮʙɼҰํʜʯ―whereas は硬い表現",
        "answer": ", while [whereas] I am good at basketball. ʙ, while … ʙ, whereas … ʮʙɼҰํʜʯ―whereas は硬い表現",
        "explanation": "▶ 「～」と「…」の対比を表す。この用法では節をコンマで区切ることが多い。",
        "question": "Ken plays soccer very well  good at basketball."
    },
    {
        "id": "268",
        "ja": "発展 手伝う気はあるけれど，今日は十分な時間がない。",
        "en": "{While I’m willing to help, I don’t have enough time today. ⇧ 「…する一方 ⭢ …だけれども」}",
        "answer": "While I’m willing to help, I don’t have enough time today. ⇧ 「…する一方 ⭢ …だけれども」",
        "explanation": "▶ 譲歩を表すwhile。この用法ではwhile節は主節の前 （文頭） に置く。",
        "question": "(W     ) (        ) (w     ) (        ) help, I don’t have enough time today."
    },
    {
        "id": "269",
        "ja": "私たちの計画は思った通りには行かなかった。 the way … ʮʜ͢ΔΑ͏ʹʯ―副詞節を導くthe way。as と同じ意味。 the way … には「…する方法，やり方」 （名詞節） という意味もある。➡205-1",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "Our plan did not work out (t      ) (w     ) (        ) (        ) (e      ). workwork  outout ͸ʮ͏·͍͘͘ʯͷҙຯɻ͸ʮ͏·͍͘͘ʯͷҙຯɻ ＝ Our plan did not work out the way we had expected. Our plan did not work out as we had expected."
    },
    {
        "id": "270",
        "ja": "雨に備えて，私はいつも傘を持って行く。 in case …ʹඋ͑ͯɼʜ͢Δͱ͍͚ͳ͍͔Βʯ―条件を表す副詞節",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "I always take an umbrella (        ) (        ) (        ) (        ). I always take an umbrella in case it rains. in case it rainsΔͱ͍͚ͳ͍͔Βʯ"
    },
    {
        "id": "271",
        "ja": "太るといけないから，父は毎日運動をしている。 for fear（that） の後は肯定文。 「…することを恐れて」 。not などの否定語は不要。",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "My father exercises every day (        ) (f      ) (        ) (        ) (        ) (g      ) weight. My father exercises every day for fear that he will gain weight. for fear (that) …ʮʜ͢Δͱ͍͚ͳ͍͔Βɼʜ͠ͳ͍Α͏ʹʯ gain weight ʮଠΔʯ⇔⇔ lose weightྔ͢Δʯ"
    },
    {
        "id": "272",
        "ja": "発展 日に焼けるのが 嫌なことを除けば，ビーチへ行くのは好きだ。 復習",
        "en": "???",
        "answer": "???",
        "explanation": "",
        "question": "I like going to the beach,  getting sunburned. I like going to the beach, except (that) I don’t like getting sunburned. except (that) …ʮʜͱ͍͏͜ͱΛআ͍ͯʯ except (for) AʮA Λআ͍ͯʯ＝but A  ➡766 get sunburned ʮ೔ম͚͢Δʯ willing / expect / gain 132 133 Self Check"
    },
    {
        "id": "273",
        "ja": "???",
        "en": "⑨",
        "answer": "???",
        "explanation": "",
        "question": "???"
    },
    {
        "id": "273-1",
        "ja": "科学技術がより進歩するにつれて，社会はますますそれに依存するようになる。",
        "en": "{As technology becomes more advanced, society becomes more dependent on it. as …ʮʜ͢ΔʹͭΕͯʯ―２つの事柄が同時に起こることを表す。}",
        "answer": "As technology becomes more advanced, society becomes more dependent on it. as …ʮʜ͢ΔʹͭΕͯʯ―２つの事柄が同時に起こることを表す。",
        "explanation": "▶ 比例を表すas。➡Grasp18\nbecome dependent on A ʮA ʹཔΔΑ͏ʹͳΔʯ\n⇔⇔ become independent from [of] AʮA ͔Βಠཱ͢Δʯ",
        "question": "( advanced / technology / becomes / as / more ), society becomes more dependent on it. ʮΑΓਐา͢Δ ˠ ͢ΔɻʮΑΓਐา͢Δ ˠ ͢Δɻ"
    },
    {
        "id": "273-2",
        "ja": "ローマにいる時はローマ人のするようにせよ。",
        "en": "When in Rome, do {as the Romans do. as …ʮʜ͢ΔΑ͏ʹɼʜ͢Δͷͱಉ༷ʹʯ}",
        "answer": "as the Romans do. as …ʮʜ͢ΔΑ͏ʹɼʜ͢Δͷͱಉ༷ʹʯ",
        "explanation": "▶ 様態を表すas。➡Grasp18\nas you can see , …ʮ͓Θ͔ΓͷΑ͏ʹ…ʯ\nas everyone knows , …ʮΈͳ͞Μ͝ଘ͡ͷΑ͏ʹ…ʯ\nthe Romans ʮϩʔϚਓʯ",
        "question": "When in Rome, do ."
    },
    {
        "id": "274",
        "ja": "発展 部屋はそのままにし ておいて。後で掃除するから。",
        "en": "Leave the room {as it is. I’ll clean it later. ⇧「 そ れ（it）が そ う で あ る（is）よう に（as）」}",
        "answer": "as it is. I’ll clean it later. ⇧「 そ れ（it）が そ う で あ る（is）よう に（as）」",
        "explanation": "▶ 様態を表すas。〈as＋S′＋be動詞〉 のS′ に当たる代名詞は同じ文の中に登場\nする名詞を指す。この文ではit はthe room を指す。\nthe Romans\n(5) 譲歩を表すas …ʮʜ͚ͩΕͲ΋ʯ―接続詞\nC˄（ͳͲ）ʴas S′ʴV′… の形で使う。\nTired as I was, I went out. ＝ Though I was tired, …\n（疲れていたけれども，私は外出した。 ）\nʧ\n(6) 役割を表すas ～ʮʙͱͯ͠ʯ―前置詞\nAs a leader, I always listen to everyoneʼs opinion.\n（リーダーとして，私は常にみんなの意見に耳を傾ける。 ）\nʹϦʔμʔʧ\n(7) 名詞を修飾するas …ʮʜ͢ΔΑ͏ͳʯ―関係代名詞\nSocial media can help you find people who have the same hobbies as you.\n（ソーシャルメディアはあなたと同じ趣味を持つ人を見つけるのに役立つ。 ）\nʦਓʑͷझຯʹ͋ͳͨͷझຯʧ\n(8) 比較を表すas ～ʮಉ͘͡Β͍ ʙʯ―副詞\nGetting regular exercise is as important as eating a balanced diet.\n副詞                  接続詞「…と同じくらい」\n（定期的に運動をすることはバランスのとれた食事をとるのと同じくらい重 要 だ 。）\nͷॏཁੑʧ\nas は多くの意味を持つため，文脈と品詞から意味を判断する必要がある。基本的には\n２つの事柄について等しい関係や同時性を表すと考えるとわかりやすい。\n(1) 様態を表すas …ʮʜ͢ΔΑ͏ʹɼʜ͢Δͷͱಉ༷ʹʯ―接続詞\nI want you to do as I say.\n（君に私の言うとおりにし て ほ し い 。）\n͏͜ͱʧ\n(2) 時（同時）を表すas …ʹɼʜ͠ͳ͕Βʯ―接続詞\nAs I came home, it started to rain.\n（帰宅すると， 雨 が 降 り 始 め た 。）\nʧ\n(3) 比例を表すas …ʮʜ͢ΔʹͭΕͯʯ―接続詞\nAs you climb higher, the air gets thinner.\n（高く登るにつれて，空気が薄く なる。 ）\n͕ബ͘ͳΔʧ\nAs I was tired, I went to bed early.\n（疲れていたので， 私 は 早 く 寝 た 。）\nʧ\nasͷ͞·͟·ͳ༻๏18Grasp\n134 135\n復習\nSelf\nCheck",
        "question": "Leave the room (        ) (        ) (        ). I’ll clean it later."
    }
];

        // --- App State ---
        let activeSentenceElement = null;
        let selectedSentences = new Set();
        let SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition;
        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.lang = 'en-US';
            recognition.interimResults = false;
        }
        
        // --- Voice Synthesis Setup ---
        let synthesisVoice = null;

        function setSynthesisVoice() {
            const voices = speechSynthesis.getVoices();
            // 優先順位: Google US English -> Microsoft Zira/David -> その他英語
            synthesisVoice = voices.find(voice => voice.name === 'Google US English') ||
                             voices.find(voice => voice.name.includes('Google') && voice.lang.includes('en-US')) ||
                             voices.find(voice => voice.name.includes('Microsoft') && voice.lang.includes('en-US')) ||
                             voices.find(voice => voice.lang === 'en-US') ||
                             voices.find(voice => voice.lang.startsWith('en'));
        }

        // 音声リストがロードされたら設定を実行
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = setSynthesisVoice;
        }
        // 初期化時にも実行
        setSynthesisVoice();


        // --- DOM Elements ---
        const sentenceList = document.getElementById('sentence-list');
        const toggleAnswerBtn = document.getElementById('toggle-answer-btn');
        const playSoundBtn = document.getElementById('play-sound-btn');
        const recordBtn = document.getElementById('record-btn');
        const toggleExplanationBtn = document.getElementById('toggle-explanation-btn');
        const startQuizBtn = document.getElementById('start-quiz-btn');
        const messageModal = document.getElementById('message-modal');
        const messageContent = document.getElementById('message-content');
        const quizModal = document.getElementById('quiz-modal');
        const closeQuizBtn = document.getElementById('close-quiz-btn');
        const quizContent = document.getElementById('quiz-content');
        
        const selectAllCheckbox = document.getElementById('select-all-checkbox');
        const pdfModal = document.getElementById('pdf-modal');
        const openPdfModalBtn = document.getElementById('open-pdf-modal-btn');
        const closeModalBtn = document.getElementById('close-modal-btn');


        // --- Functions ---

        /**
         * Parses the English sentence template and creates the HTML structure.
         */
        function formatEnglishSentence(enTemplate, answer) {
            const blank = '__________';
            const answerHtml = `<span class="answer-span">${answer}</span>`;
            const underlineHtml = `<span class="underline-span">${blank}</span>`;
            const formattedSentence = enTemplate.replace(`{${answer}}`, `${answerHtml}${underlineHtml}`);
            return formattedSentence;
        }

        /**
         * Renders all sentences for the chapter.
         */
        function renderChapter() {
            sentenceList.innerHTML = '';
            chapterData.forEach(item => {
                const sentenceDiv = document.createElement('div');
                sentenceDiv.className = 'sentence-item p-4 border border-gray-200 rounded-lg bg-white transition-shadow duration-300 hover:shadow-md cursor-pointer';
                sentenceDiv.dataset.id = item.id;
                sentenceDiv.dataset.fullSentence = item.en.replace(`{${item.answer}}`, item.answer);

                const englishSentenceHtml = formatEnglishSentence(item.en, item.answer);

                sentenceDiv.innerHTML = `
                    <div class="flex items-start space-x-4">
                         <div class="flex items-center pt-1" onclick="event.stopPropagation()">
                            <input type="checkbox" class="sentence-checkbox h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500" data-id="${item.id}">
                        </div>
                        <span class="text-lg font-bold text-gray-500 w-10 shrink-0 pt-1">${item.id}</span>
                        <div class="flex-1">
                            <p class="mb-2 text-gray-700">${item.ja}</p>
                            <p class="font-english">${englishSentenceHtml}</p>
                            <div class="explanation mt-4 p-4 bg-yellow-100 border-l-4 border-yellow-400 text-gray-700 rounded-r-lg">
                                ${item.explanation}
                            </div>
                        </div>
                    </div>
                `;
                sentenceList.appendChild(sentenceDiv);
            });
            
            // Add click listener to each sentence item
            document.querySelectorAll('.sentence-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    // Don't select if clicking inside explanation
                    if (e.target.closest('.explanation')) return;
                    if (e.target.closest('.sentence-checkbox')) return; // Checkbox click is handled separately

                    if (activeSentenceElement) {
                        activeSentenceElement.classList.remove('ring-2', 'ring-blue-400', 'shadow-xl');
                    }
                    activeSentenceElement = item;
                    activeSentenceElement.classList.add('ring-2', 'ring-blue-400', 'shadow-xl');
                });
            });

            // Checkbox logic
            document.querySelectorAll('.sentence-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', (e) => {
                    const id = e.target.dataset.id;
                    if (e.target.checked) {
                        selectedSentences.add(id);
                    } else {
                        selectedSentences.delete(id);
                    }
                });
            });
            
            // Select the first sentence by default
            if (sentenceList.firstChild) {
                 sentenceList.firstChild.click();
            }
        }
        
        // --- PDF / Print Logic ---
        
        function openPrintWindow(bodyContent, title) {
            const htmlContent = `
                <!DOCTYPE html>
                <html lang="ja">
                <head>
                    <meta charset="UTF-8">
                    <title>Insight App - Chapter 9</title>
                    <style>
                        body { font-family: "Hiragino Kaku Gothic ProN", "Meiryo", sans-serif; line-height: 1.8; margin: 25px; color: #333; }
                        @media print { .no-print { display: none; } }
                        h1, h2 { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 25px; }
                        ol, ul { list-style-position: inside; padding-left: 0; }
                        li { margin-bottom: 15px; }
                        .list-container { 
                            column-count: 2; 
                            column-gap: 40px; 
                        }
                        .list-container li, .list-container p { 
                            -webkit-column-break-inside: avoid; 
                            page-break-inside: avoid; 
                            break-inside: avoid; 
                        }
                        ol li {
                            list-style-type: decimal;
                            margin-left: 1.5em; 
                        }
                        .inline-content {
                            display: inline;
                        }
                        @media (max-width: 700px) { .list-container { column-count: 1; } }
                        .answer-key { page-break-before: always; margin-top: 50px; }
                        u { text-decoration: underline; text-underline-offset: 3px; }
                    </style>
                </head>
                <body>
                    <h1>${title}</h1>
                    <p class="no-print" style="text-align:center; margin-bottom: 20px; font-size: 0.9em; color: #666;">
                        ※印刷ダイアログが表示されない場合は、Ctrl+P (または Cmd+P) を押してください。
                    </p>
                    ${bodyContent}
                </body>
                </html>
            `;
            const printWindow = window.open('', '_blank');
            if (!printWindow) {
                showMessage('<p>ポップアップがブロックされました。設定を確認してください。</p>', 5000);
                return;
            }
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            setTimeout(() => {
                printWindow.focus(); 
                printWindow.print();
            }, 250);
        }

        function getSelectedItems() {
            if (selectedSentences.size === 0) {
                showMessage('<p>PDFを作成する問題を選択してください。</p>', 3000);
                return null;
            }
            // Sort items based on ID
            return Array.from(selectedSentences)
                .map(id => chapterData.find(item => item.id === id))
                .filter(Boolean)
                .sort((a, b) => {
                     // Handle IDs like "1382-1" vs "1382-2"
                     const aParts = a.id.split('-').map(s => parseInt(s) || 0);
                     const bParts = b.id.split('-').map(s => parseInt(s) || 0);
                     if (aParts[0] !== bParts[0]) return aParts[0] - bParts[0];
                     return (aParts[1] || 0) - (bParts[1] || 0);
                });
        }
        
        function getUniqueItems(items) {
             const uniqueMap = new Map();
             items.forEach(item => {
                 // Use answer as key to deduplicate same phrases
                 if (!uniqueMap.has(item.answer)) {
                     uniqueMap.set(item.answer, item);
                 }
             });
             return Array.from(uniqueMap.values()).sort((a, b) => {
                 const aId = parseInt(a.id.split('-')[0]);
                 const bId = parseInt(b.id.split('-')[0]);
                 return aId - bId;
             });
        }


        // --- Message & Sound Functions ---
        
        function showMessage(htmlContent, duration = null) {
            messageContent.innerHTML = htmlContent;
            messageModal.classList.remove('hidden');
            if (duration) {
                setTimeout(() => {
                    messageModal.classList.add('hidden');
                }, duration);
            }
        }

        function playSound() {
            if (!activeSentenceElement) {
                showMessage('<p>文を選択してください。</p>', 2000);
                return;
            }

            // 音声が未設定なら再取得を試みる
            if (!synthesisVoice) {
                setSynthesisVoice();
            }

            // 連続再生を防ぐために一度キャンセル
            speechSynthesis.cancel();
            
            let textToSpeak = activeSentenceElement.dataset.fullSentence;
            // 念のため不要な記号を除去
            textToSpeak = textToSpeak.replace(/[{}]/g, '');

            const utterance = new SpeechSynthesisUtterance(textToSpeak);
            utterance.lang = 'en-US';

            // 英語音声が取得できていれば設定
            if (synthesisVoice) {
                utterance.voice = synthesisVoice;
            }

            utterance.rate = 1.0; 
            utterance.pitch = 1.0;

            speechSynthesis.speak(utterance);
        }

        function handleRecording() {
            if (!activeSentenceElement) {
                showMessage('<p>文を選択してください。</p>', 2000);
                return;
            }
            if (!SpeechRecognition) {
                showMessage('<p>お使いのブラウザは音声認識に対応していません。</p>', 3000);
                return;
            }

            showMessage('<p class="text-2xl">マイクに向かって話してください...</p><div class="animate-pulse text-red-500 text-4xl mt-4">●</div>');
            
            recognition.start();

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                evaluatePronunciation(transcript);
            };

            recognition.onerror = (event) => {
                showMessage(`<p>エラーが発生しました: ${event.error}</p>`, 3000);
            };
            
            recognition.onend = () => {
                 if (messageModal.classList.contains('hidden') === false && messageContent.innerHTML.includes('マイクに')) {
                    messageModal.classList.add('hidden');
                 }
            };
        }
        
        function evaluatePronunciation(transcript) {
            const originalText = activeSentenceElement.dataset.fullSentence;

            const cleanOrig = originalText.toLowerCase().replace(/[^\w\s]/g, '').split(' ');
            const cleanTrans = transcript.toLowerCase().replace(/[^\w\s]/g, '').split(' ');
            
            let matches = 0;
            cleanOrig.forEach(word => {
                if (cleanTrans.includes(word)) {
                    matches++;
                }
            });

            const similarity = matches / cleanOrig.length;
            
            let score;
            if (similarity > 0.9) {
                score = 95 + Math.floor(Math.random() * 5);
            } else if (similarity > 0.7) {
                score = 90 + Math.floor(Math.random() * 6);
            } else if (similarity > 0.5) {
                score = 85 + Math.floor(Math.random() * 5);
            } else if (similarity > 0.3) {
                score = 80 + Math.floor(Math.random() * 5);
            } else {
                score = 70 + Math.floor(Math.random() * 10);
            }
            
            if (score === 100 && Math.random() < 0.3) score = 99;

            const messageHtml = `
                <h3 class="text-2xl font-bold mb-4">評価結果</h3>
                <p class="text-7xl font-bold text-blue-600 mb-4">${score}<span class="text-2xl">点</span></p>
                <p class="text-gray-600 mb-2"><strong>あなたの発音:</strong> ${transcript}</p>
                <p class="text-gray-600"><strong>元の文:</strong> ${originalText}</p>
                <button onclick="document.getElementById('message-modal').classList.add('hidden')" class="mt-6 bg-blue-500 text-white py-2 px-6 rounded-lg">閉じる</button>
            `;
            showMessage(messageHtml);
        }

        // --- Quiz Functions ---

        function startQuiz() {
            if (chapterData.length < 10) {
                 showMessage('<p>クイズを作成するには、文が10個以上必要です。</p>', 3000);
                 return;
            }

            const shuffled = [...chapterData].sort(() => 0.5 - Math.random());
            const questions = shuffled.slice(0, 10);

            let currentQuestionIndex = 0;
            let score = 0;

            function showQuestion() {
                if (currentQuestionIndex >= questions.length) {
                    showQuizResult();
                    return;
                }

                const question = questions[currentQuestionIndex];
                const correctAnswer = question.answer;

                const incorrectAnswers = chapterData
                    .filter(item => item.answer !== correctAnswer)
                    .sort(() => 0.5 - Math.random())
                    .slice(0, 3)
                    .map(item => item.answer);

                const options = [correctAnswer, ...incorrectAnswers].sort(() => 0.5 - Math.random());
                
                const questionSentence = question.en.replace(`{${question.answer}}`, ' (______) ');

                quizContent.innerHTML = `
                    <h3 class="text-2xl font-bold mb-2">問題 ${currentQuestionIndex + 1}/10</h3>
                    <p class="text-lg mb-4">${question.ja}</p>
                    <p class="font-english text-xl mb-6 p-4 bg-gray-100 rounded-lg">${questionSentence}</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        ${options.map(opt => `<button class="quiz-option p-4 bg-blue-100 hover:bg-blue-200 rounded-lg text-left text-lg font-english" data-answer="${opt}">${opt}</button>`).join('')}
                    </div>
                `;

                document.querySelectorAll('.quiz-option').forEach(button => {
                    button.addEventListener('click', () => {
                        if (button.dataset.answer === correctAnswer) {
                            score++;
                            button.classList.add('bg-green-400', 'text-white');
                        } else {
                            button.classList.add('bg-red-400', 'text-white');
                            document.querySelector(`.quiz-option[data-answer="${CSS.escape(correctAnswer)}"]`).classList.add('bg-green-400', 'text-white');
                        }
                        
                        setTimeout(() => {
                            currentQuestionIndex++;
                            showQuestion();
                        }, 1200);
                    });
                });
            }

            function showQuizResult() {
                quizContent.innerHTML = `
                    <h3 class="text-3xl font-bold mb-4 text-center">テスト終了！</h3>
                    <p class="text-center text-xl mb-6">あなたのスコアは...</p>
                    <p class="text-center text-7xl font-bold text-purple-600">${score * 10}<span class="text-3xl">点</span></p>
                    <p class="text-center text-xl mt-2">(${questions.length}問中 ${score}問正解)</p>
                `;
            }

            showQuestion();
            quizModal.classList.remove('hidden');
        }


        // --- Event Listeners ---

        toggleAnswerBtn.addEventListener('click', () => {
            if (!activeSentenceElement) {
                showMessage('<p>文を選択してください。</p>', 2000);
                return;
            }
            activeSentenceElement.classList.toggle('show-answer');
        });

        toggleExplanationBtn.addEventListener('click', () => {
            if (!activeSentenceElement) {
                showMessage('<p>文を選択してください。</p>', 2000);
                return;
            }
            const explanationDiv = activeSentenceElement.querySelector('.explanation');
            if (explanationDiv.style.display === 'block') {
                explanationDiv.style.display = 'none';
            } else {
                explanationDiv.style.display = 'block';
            }
        });
        
        playSoundBtn.addEventListener('click', playSound);
        recordBtn.addEventListener('click', handleRecording);
        startQuizBtn.addEventListener('click', startQuiz);
        closeQuizBtn.addEventListener('click', () => quizModal.classList.add('hidden'));
        
        // Select All Logic
        selectAllCheckbox.addEventListener('change', (e) => {
            const isChecked = e.target.checked;
            const checkboxes = document.querySelectorAll('.sentence-checkbox');
            checkboxes.forEach(cb => {
                cb.checked = isChecked;
                if (isChecked) selectedSentences.add(cb.dataset.id);
                else selectedSentences.delete(cb.dataset.id);
            });
        });

        // PDF Modal Logic
        openPdfModalBtn.addEventListener('click', () => {
             if (selectedSentences.size === 0) {
                showMessage('<p>PDFを作成する問題を選択してください。</p>', 3000);
                return;
            }
            pdfModal.classList.remove('hidden');
        });
        closeModalBtn.addEventListener('click', () => pdfModal.classList.add('hidden'));

        // --- PDF Generation Buttons Listeners ---

        // 変更: PDF内のサブタイトルを「Insight 英文法・語法・熟語 ＋ 章とその題」の形式にする
        // h1: "Insight 英文法・語法・熟語"
        // h2: "学習用サイト（28章 その他の重要熟語）" -> "（28章 その他の重要熟語）" の部分を抽出して結合
        const mainTitle = document.querySelector('header h1').innerText;
        const subTitleRaw = document.getElementById('app-subtitle').innerText;
        // "学習用サイト" という文字が含まれていれば削除して整形
        const chapterTitle = subTitleRaw.replace('学習用サイト', '').trim();
        const subtitleText = `${mainTitle} ${chapterTitle}`;

        // 1. 完全なリスト
        document.getElementById('download-list-btn').addEventListener('click', () => {
            const items = getSelectedItems();
            if(!items) return;
            // リスト作成の場合は重複があっても良いが、見やすくするために熟語ベースでユニークにするか、
            // そのままID順で並べるか。ここではID順ですべて表示する。
            
            const listItems = items.map(item => {
                // Remove { } for clean display
                const cleanEn = item.en.replace(/[{}]/g, '');
                return `<li>
                    <span class="inline-content"><strong>${item.answer}</strong>: ${item.explanation.replace(/\n/g, '<br>')}</span><br>
                    <span style="font-size:0.9em; color:#555;">Ex: ${cleanEn} / ${item.ja}</span>
                </li>`;
            }).join('');
            
            openPrintWindow(`<ul class="list-container">${listItems}</ul>`, '重要熟語リスト');
            pdfModal.classList.add('hidden');
        });

        // 2. 英語を解答
        document.getElementById('download-en-quiz-btn').addEventListener('click', () => {
            const items = getUniqueItems(getSelectedItems());
            
            const quizItems = items.map(item => 
                `<li><span class="inline-content">${item.explanation.replace(/\n/g, ' ')} : ____________________</span></li>`
            ).join('');
            const answerItems = items.map(item => 
                `<li><span class="inline-content">${item.answer}</span></li>`
            ).join('');
            
            const body = `<h2>${subtitleText}</h2><ol class="list-container">${quizItems}</ol><div class="answer-key"><h2>解答</h2><ol class="list-container">${answerItems}</ol></div>`;
            openPrintWindow(body, '熟語テスト (英語を解答)');
            pdfModal.classList.add('hidden');
        });

        // 3. 意味を解答
        document.getElementById('download-ja-quiz-btn').addEventListener('click', () => {
            const items = getUniqueItems(getSelectedItems());
            
            const quizItems = items.map(item => 
                `<li><span class="inline-content"><strong>${item.answer}</strong> : ____________________</span></li>`
            ).join('');
            const answerItems = items.map(item => 
                `<li><span class="inline-content">${item.explanation.replace(/\n/g, ' ')}</span></li>`
            ).join('');
            
            const body = `<h2>${subtitleText}</h2><ol class="list-container">${quizItems}</ol><div class="answer-key"><h2>解答</h2><ol class="list-container">${answerItems}</ol></div>`;
            openPrintWindow(body, '熟語テスト (意味を解答)');
            pdfModal.classList.add('hidden');
        });

        // 4. 混合
        document.getElementById('download-mixed-quiz-btn').addEventListener('click', () => {
            const items = getUniqueItems(getSelectedItems());
            let quizItems = '';
            let answerItems = '';
            
            items.forEach(item => {
                if (Math.random() > 0.5) {
                    // 日本語 -> 英語
                    quizItems += `<li><span class="inline-content">${item.explanation.replace(/\n/g, ' ')} : ____________________</span></li>`;
                    answerItems += `<li><span class="inline-content">${item.answer}</span></li>`;
                } else {
                    // 英語 -> 日本語
                    quizItems += `<li><span class="inline-content"><strong>${item.answer}</strong> : ____________________</span></li>`;
                    answerItems += `<li><span class="inline-content">${item.explanation.replace(/\n/g, ' ')}</span></li>`;
                }
            });
            
            const body = `<h2>${subtitleText}</h2><ol class="list-container">${quizItems}</ol><div class="answer-key"><h2>解答</h2><ol class="list-container">${answerItems}</ol></div>`;
            openPrintWindow(body, '熟語テスト (混合)');
            pdfModal.classList.add('hidden');
        });

        // 5. 例文穴埋め
        document.getElementById('download-sentence-quiz-btn').addEventListener('click', () => {
            const items = getSelectedItems(); // 例文問題なので重複（文脈違い）も含める
            
            const quizItems = items.map(item => {
                // Replace {answer} with underscore
                const blankSentence = item.en.replace(`{${item.answer}}`, '____________________');
                return `<li>${blankSentence}<br><span style="font-size:0.9em;">(${item.ja})</span></li>`;
            }).join('');
            
            const answerItems = items.map(item => 
                `<li>${item.answer}</li>`
            ).join('');

            const body = `<h2>${subtitleText}</h2><ol>${quizItems}</ol><div class="answer-key"><h2>解答</h2><ol class="list-container">${answerItems}</ol></div>`;
            openPrintWindow(body, '熟語テスト (例文穴埋め)');
            pdfModal.classList.add('hidden');
        });

        // 6. 例文混合 (穴埋め / 下線部和訳)
        document.getElementById('download-sentence-mixed-quiz-btn').addEventListener('click', () => {
            const items = getSelectedItems();
            let quizItems = '';
            let answerItems = '';
            
            const instruction = '<p style="border:1px solid #ccc; padding:10px; margin-bottom:20px;">指示：空所には適切な語句を補い、下線部がある文は下線部の意味を日本語で答えなさい。</p>';

            items.forEach(item => {
                if (Math.random() > 0.5) {
                    // 穴埋め
                    const blankSentence = item.en.replace(`{${item.answer}}`, '____________________');
                    quizItems += `<li>${blankSentence}<br><span style="font-size:0.9em;">(${item.ja})</span></li>`;
                    answerItems += `<li>${item.answer}</li>`;
                } else {
                    // 下線部和訳 (ここでは熟語の意味を問う形にする)
                    const underlineSentence = item.en.replace(`{${item.answer}}`, `<u>${item.answer}</u>`);
                    quizItems += `<li>${underlineSentence}<br>意味: ____________________</li>`;
                    answerItems += `<li>${item.explanation.split('\n')[0]}</li>`; // 解説の1行目を答えとする
                }
            });

            const body = `<h2>${subtitleText}</h2>${instruction}<ol>${quizItems}</ol><div class="answer-key"><h2>解答</h2><ol class="list-container">${answerItems}</ol></div>`;
            openPrintWindow(body, '熟語テスト (例文混合)');
            pdfModal.classList.add('hidden');
        });


        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', () => {
            renderChapter();
        });
    </script>
</body>
</html>